(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1473:function(e,n,r){"use strict";r.r(n);var t=r(206),a=r(239),c=r.n(a),s=r(240),o=r(43),u=r(44),l=r(63),i=r(45),p=r(65),h=r(0),d=r.n(h),f=r(62),m=r(1243),g=r(1251),v=r(1253),R=r.n(v),b=(r(1254),r(21)),k=r(39),y=r.n(k),x=r(11),C=r(41),E=r(42),S=r(1256),w=r.n(S);var O=Object(b.withStyles)(function(e){return{}})(function(){return d.a.createElement("span",null,d.a.createElement("br",null),d.a.createElement(w.a,null),d.a.createElement("br",null),d.a.createElement(w.a,{color:"secondary",variant:"query"}),d.a.createElement("br",null),d.a.createElement(w.a,null))}),N=r(173),P=r.n(N),j=r(176),T=r.n(j);var I=Object(b.withStyles)(function(e){return{noRaces:{marginRight:"10px",marginLeft:"10px",marginTop:"5px",marginBottom:"5px"}}})(function(e){var n=e.classes;return d.a.createElement(P.a,{className:n.noRaces},d.a.createElement(T.a,{variant:"subheading"},"No race results found for this runner!"))}),L=r(1260),D=r.n(L);function B(e){var n=e.key,r=e.value;"null"!==r&&sessionStorage.setItem(n,JSON.stringify(r))}function J(e){var n=sessionStorage.getItem(e);return n?JSON.parse(n):n}function z(e){e&&sessionStorage.removeItem(e)}function F(e){var n=e.key,r=e.value;"null"!==r&&localStorage.setItem(n,JSON.stringify(r))}var M=new(r(1280).AllHtmlEntities);function q(e,n,r){return $.apply(this,arguments)}function $(){return($=Object(s.a)(c.a.mark(function e(n,r,t){var a,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.join("$$"),s=null,e.next=4,D.a.get("".concat("https://fellrace-finder-server.herokuapp.com","/runner/").concat(a,"/").concat(r,"/").concat(t)).then(function(e){return s=e.data}).catch(function(e){console.log(e)});case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function A(e,n){return K.apply(this,arguments)}function K(){return(K=Object(s.a)(c.a.mark(function e(n,r){var t,a,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.join("$$"),a=r.replace("/","**"),a=M.encode(a),s=null,e.next=6,D.a.get("".concat("https://fellrace-finder-server.herokuapp.com","/runnerByRace/").concat(t,"/").concat(a)).then(function(e){return s=e.data}).catch(function(e){console.log(e)});case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function U(e){var n="runnersList".concat(e),r=J(n);if(r)return{options:r};var t="".concat("https://fellrace-finder-server.herokuapp.com","/autocomplete/runner/").concat(e.toLowerCase());return fetch(t).then(function(e){return e.json()}).then(function(e){var r=[];return e.items.map(function(e){var n=!1;return r.map(function(r){return e.display===r.display&&(n=!0,!0)}),n||r.push(e),n}),B({key:n,value:r}),{options:r}})}function Y(e){var n=e.split(" ").map(function(e){return"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)," ")}),r="";return n.map(function(e){return r="".concat(r).concat(e)}),r}var H=d.a.lazy(function(){return Promise.all([r.e(0),r.e(1),r.e(6)]).then(r.bind(null,1464))}),W=d.a.lazy(function(){return Promise.all([r.e(0),r.e(1),r.e(7)]).then(r.bind(null,1465))}),G=d.a.lazy(function(){return Promise.all([r.e(0),r.e(1),r.e(8)]).then(r.bind(null,1466))}),Q=d.a.lazy(function(){return Promise.all([r.e(0),r.e(1),r.e(9)]).then(r.bind(null,1467))}),V=d.a.lazy(function(){return Promise.all([r.e(1),r.e(22),r.e(10)]).then(r.bind(null,1468))}),X=d.a.lazy(function(){return Promise.all([r.e(2),r.e(11)]).then(r.bind(null,1469))}),Z=d.a.lazy(function(){return Promise.all([r.e(0),r.e(19),r.e(12)]).then(r.bind(null,1470))}),_=d.a.lazy(function(){return Promise.all([r.e(0),r.e(1),r.e(21),r.e(13)]).then(r.bind(null,1471))}),ee=d.a.lazy(function(){return Promise.all([r.e(0),r.e(14)]).then(r.bind(null,1472))}),ne=function(e){return{searchField:{paddingBottom:"5px",paddingLeft:"5px",paddingRight:"5px",marginTop:"-15px",zIndex:"2"},search:{position:"sticky",backgroundColor:"white",zIndex:"2 !important",borderBottom:"1px solid #CCCCCC",top:"20px",paddingTop:"20px",borderTop:"1px solid #CCCCCC",paddingBottom:"2px"},progress:{margin:2*e.spacing.unit}}},re="chosenRunners",te=0,ae=function(e){function n(e){var r;return Object(o.a)(this,n),(r=Object(l.a)(this,Object(i.a)(n).call(this,e))).componentDidMount=function(){window.addEventListener("scroll",r.onScroll,!1);var e=function(e){var n=localStorage.getItem(e);return n?JSON.parse(n):n}(re);e&&(r.props.dispatchChosenRunners(e),r.onChange(e))},r.componentWillUnmount=function(){window.removeEventListener("scroll",r.onScroll,!1)},r.buildClearButton=function(){return d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:ne.prototypeprogress})},d.a.createElement(G,{onClick:r.clearClick}))},r.onScroll=function(){window.scrollY>=165&&!r.props.scrollReducer.sticky?r.props.dispatchSticky(!0):window.scrollY<165&&r.props.scrollReducer.sticky&&r.props.dispatchSticky(!1)},r.scrollToTop=function(){m.animateScroll.scrollTo(170)},r.performSearch=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,a,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=19;break}if(r.props.dispatchLoadingProgress(!0),r.props.dispatchRunnerDetails(null),r.props.dispatchChosenRace(""),t=r.props.searchReducer.endIndex,a="getRunner".concat(n).replace(" ",""),s=J(a)){e.next=14;break}return e.next=10,q(n,te,t);case 10:o=e.sent,B({key:a,value:JSON.stringify(o)}),e.next=16;break;case 14:o=JSON.parse(s),z(a);case 16:r.props.dispatchRunnerDetails(o),r.props.dispatchLoadingProgress(!1),r.scrollToTop();case 19:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),r.searchForRunners=function(){var e=Object(s.a)(c.a.mark(function e(n,r){var t,a,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=16;break}if(t=[],n.map(function(e){t.push(e.display)}),a="getRunners".concat(t.join("")).concat(te).concat(r).replace(" ",""),s=J(a)){e.next=13;break}return e.next=8,q(t,te,r);case 8:return o=e.sent,B({key:a,value:JSON.stringify(o)}),e.abrupt("return",o);case 13:o=JSON.parse(s),z(a);case 15:return e.abrupt("return",o);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e,this)}));return function(n,r){return e.apply(this,arguments)}}(),r.searchForRunnersByRace=function(){var e=Object(s.a)(c.a.mark(function e(n,r){var t,a,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=16;break}if(t=[],n.map(function(e){t.push(e.display)}),a="getRunnersByRace".concat(t.join("")).concat(r).replace(" ",""),s=J(a)){e.next=13;break}return e.next=8,A(t,r);case 8:return o=e.sent,B({key:a,value:JSON.stringify(o)}),e.abrupt("return",o);case 13:o=JSON.parse(s),z(a);case 15:return e.abrupt("return",o);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e,this)}));return function(n,r){return e.apply(this,arguments)}}(),r.handleClick=function(){var e=Object(s.a)(c.a.mark(function e(n){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""===(t=r.searchRunnerRef.value.trim())){e.next=8;break}if(Y(t)===r.state.runnerName){e.next=6;break}return e.next=6,r.performSearch(t);case 6:e.next=9;break;case 8:r.clearClick();case 9:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),r.clearClick=function(){var e;r.props.dispatchLoadingProgress(!0),r.props.dispatchRunnerDetails(null),r.props.dispatchSticky(!1),r.props.dispatchChosenRunners([]),r.props.dispatchChosenRace(""),r.props.dispatchEndIndex(0),(e=re)&&localStorage.removeItem(e),sessionStorage.clear(),r.props.dispatchLoadingProgress(!1),m.animateScroll.scrollToTop()},r.scrollToTopClick=function(e){e.preventDefault(),m.animateScroll.scrollToTop()},r.scrollToBottomClick=function(e){e.preventDefault(),m.animateScroll.scrollToBottom()},r.loadingProgress=function(){return d.a.createElement(O,null)},r.noResultsFound=function(){return d.a.createElement(I,null)},r.buildRaceResult=function(e){var n,r=e;return r&&r.length>0&&(r=r[0]),r.raceInfo&&(n=d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:ne.progress})},d.a.createElement(X,{raceInfo:r.raceInfo}))),d.a.createElement("div",{key:r.id},d.a.createElement("br",null),d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:ne.progress})},d.a.createElement(Q,{race:r})),n,d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:ne.progress})},d.a.createElement(V,{runner:r.runner})))},r.loadMoreOnClick=function(){var e=Object(s.a)(c.a.mark(function e(n){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=r.props.searchReducer.chosenRunners,r.props.dispatchLoadMoreProgress(!0),e.next=5,r.onChange(t);case 5:r.props.dispatchLoadMoreProgress(!1);case 6:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),r.calculateNextEndIndex=function(e){var n=r.props.runnerReducer.runnerDetails,t=r.props.searchReducer,a=t.endIndex,c=t.chosenRunners;return 0===a?10:e.length===c.length?a+10>n.overallStats.noOfRaces?n.overallStats.noOfRaces:a+10:10},r.onChange=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,a,s,o,u,l,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.props.runnerReducer.runnersDetails,a=r.props.searchReducer,s=a.chosenRunners,o=a.chosenRace,u=a.endIndex,!(n.length>0)){e.next=16;break}return r.props.dispatchLoadingProgress(!0),l=r.calculateNextEndIndex(n),e.next=7,r.searchForRunners(n,l);case 7:i=e.sent,R.a.isEqual(s,n)||r.props.dispatchChosenRunners(n),R.a.isEqual(t,i)||r.props.dispatchRunnerDetails(i),u!==l&&r.props.dispatchEndIndex(l),""!==o&&r.props.dispatchChosenRace(""),F({key:re,value:n}),r.props.dispatchLoadingProgress(!1),e.next=17;break;case 16:r.clearClick();case 17:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),r.fetchRunnerByRace=function(){var e=Object(s.a)(c.a.mark(function e(n,t){var a,s,o,u,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.props.runnerReducer.runnersDetails,s=r.props.searchReducer,o=s.chosenRace,u=s.chosenRunners,!(n.length>0)){e.next=13;break}return e.next=5,r.searchForRunnersByRace(n,t);case 5:l=e.sent,t!==o&&r.props.dispatchChosenRace(t),R.a.isEqual(n,u)||r.props.dispatchChosenRunners(n),R.a.isEqual(a,l)||r.props.dispatchRunnerDetails(l),F({key:re,value:n}),r.props.dispatchLoadingProgress(!1),e.next=14;break;case 13:r.clearClick();case 14:case"end":return e.stop()}},e,this)}));return function(n,r){return e.apply(this,arguments)}}(),r.fetchRunners=function(){var e=Object(s.a)(c.a.mark(function e(n,r){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("searching - ",n),n||r(null,{options:[]}),!(n.length>2)){e.next=10;break}return e.t0=r,e.next=6,U(n);case 6:e.t1=e.sent,(0,e.t0)(null,e.t1),e.next=11;break;case 10:r(null,{options:[]});case 11:case"end":return e.stop()}},e,this)}));return function(n,r){return e.apply(this,arguments)}}(),r.debouncedFetchRunners=R.a.debounce(r.fetchRunners,100),r.getRunners=function(e,n){if(!e||e.length<4)return n(null,{options:[]});r.debouncedFetchRunners(e,n)},r.handleChooseRaceChange=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,a,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.props.searchReducer,a=t.chosenRunners,s=t.endIndex,o=n.target.value,r.props.dispatchLoadingProgress(!0),0!==s&&r.props.dispatchEndIndex(0),"all"!==o){e.next=9;break}return e.next=7,r.onChange(a);case 7:e.next=11;break;case 9:return e.next=11,r.fetchRunnerByRace(a,o);case 11:r.scrollToTop();case 12:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),r.populateOverallStats=function(){var e=r.props.runnerReducer.runnerDetails;return e.overallStats?d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:ne.progress})},d.a.createElement(_,{overallStats:e.overallStats})):null},r.buildChosenRaceList=function(e,n){var t=[];e||(e="");var a=e.split("||");return a.length>1?a.map(function(e){for(var r=0;r<n.length;r++)n[r].name===e&&t.push(n[r])}):n&&(t=n),t.length>1&&(t=t.sort(function(e,n){return new Date(n.dateTime)-new Date(e.dateTime)})),t.map(function(e){return r.buildRaceResult(e)})},r.searchRunnerRef=d.a.createRef(),r}return Object(p.a)(n,e),Object(u.a)(n,[{key:"render",value:function(){var e,n,r,t,a,c,s,o,u,l=this,i=this.props.classes,p=i.progress,f=i.searchField,v=i.search,R=this.props.searchReducer,b=R.loadingProgress,k=R.chosenRunners,x=R.chosenRace,C=R.loadMoreLoading,E=this.props.runnerReducer.runnerDetails,S=this.props.scrollReducer.sticky,w=S?v:"",O=this.props.searchReducer.endIndex;if(b&&(t=this.loadingProgress()),null!=E&&E.races&&E.races.length>0){e=this.buildClearButton(),n=this.populateOverallStats();var N=E.races;0===O&&(O=10),""===x?(r=N.map(function(e){return l.buildRaceResult(e)}),E.overallStats.noOfRaces>O&&(s=d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:p})},d.a.createElement(ee,{onClick:this.loadMoreOnClick})))):(r=this.buildChosenRaceList(x,E.races)).length>O&&(s=d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:p})},d.a.createElement(ee,{onClick:this.loadMoreOnClick}))),c=d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:p})},d.a.createElement(Z,{raceNames:E.raceNames,chosenRace:x,onChange:this.handleChooseRaceChange})),C?(o=this.loadingProgress(),s=null,m.animateScroll.scrollMore(250)):(u=d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:p})},d.a.createElement(W,{onClick:this.scrollToBottomClick})),S&&(a=d.a.createElement(h.Suspense,{fallback:d.a.createElement(y.a,{className:p})},d.a.createElement(H,{onClick:this.scrollToTopClick}))))}else null!=E&&0===E.races.length&&(r=this.noResultsFound());return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:w},d.a.createElement(g.a,{cacheOptions:!0,defaultOptions:!0,className:f,valueKey:"original",labelKey:"display",matchProp:"any",name:"runner-search-field",onChange:this.onChange,loadOptions:this.getRunners,placeholder:"Search Runner",noResultsText:"No runners found",value:k,multi:!0,ignoreAccents:!1}),c,e),u,t,n,r,o,s,a)}}]),n}(h.PureComponent);n.default=Object(f.b)(function(e){return Object(t.a)({},e)},function(e){return{dispatchLoadingProgress:function(n){return e(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n){n({type:x.d,payload:e})}}(n))},dispatchRunnerDetails:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(n){n({type:C.a,payload:e})}}(n))},dispatchSticky:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){n({type:E.a,payload:e})}}(n))},dispatchChosenRunners:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(n){n({type:x.b,payload:e})}}(n))},dispatchChosenRace:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(n){n({type:x.a,payload:e})}}(n))},dispatchEndIndex:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(n){n({type:x.c,payload:e})}}(n))},dispatchLoadMoreProgress:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){n({type:x.e,payload:e})}}(n))}}})(Object(b.withStyles)(ne)(ae))}}]);
//# sourceMappingURL=5.19a2e615.chunk.js.map