(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1680:function(e,n,a){"use strict";a.r(n);var t=a(193),r=a(230),c=a.n(r),s=a(231),o=a(42),i=a(43),l=a(47),u=a(44),p=a(48),d=a(0),h=a.n(d),f=a(46),m=a(229),g=a(79),b=a.n(g),v=a(25),R=a(1387),k=a.n(R),y=a(71),E=a.n(y),C=a(1337),x=a.n(C),O=a(1340),S=a.n(O),w=a(325),j=a.n(w),P=a(1422),T=a.n(P),N=a(302),L=a.n(N),D=a(259),I=a.n(D),B=a(275),q=a.n(B),M=a(276),z=a.n(M),F=a(326),A=a.n(F),J=a(1426),Y=a.n(J),K=a(1428),U=a.n(K),G=a(278),$=a.n(G),H=a(279),W=a.n(H),_=a(39),Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(n){n({type:_.b,payload:e})}},V=function(e){function n(e){var a;return Object(o.a)(this,n),(a=Object(l.a)(this,Object(u.a)(n).call(this,e))).handleDrawerOpen=function(){a.props.dispatchMenuToggleAction(!0)},a.handleDrawerClose=function(){a.props.dispatchMenuToggleAction(!1)},a}return Object(p.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){var e=this.props,n=e.classes,a=e.theme,t=e.runnerOnClick,r=e.raceOnClick,c=e.menuReducer.menuOpen;return h.a.createElement("div",{className:n.root},h.a.createElement(E.a,null),h.a.createElement(x.a,{position:"fixed",className:b()(n.appBar,Object(m.a)({},n.appBarShift,c))},h.a.createElement(S.a,{disableGutters:c},h.a.createElement(L.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerOpen,className:b()(n.menuButton,c&&n.hide)},h.a.createElement(I.a,null)))),h.a.createElement(k.a,{className:n.drawer,variant:"persistent",anchor:"left",open:c,classes:{paper:n.drawerPaper}},h.a.createElement("div",{className:n.drawerHeader},h.a.createElement(L.a,{onClick:this.handleDrawerClose},"ltr"===a.direction?h.a.createElement(q.a,null):h.a.createElement(z.a,null))),h.a.createElement(T.a,null),h.a.createElement(j.a,null,h.a.createElement(A.a,{button:!0,key:"Runner",onClick:t},h.a.createElement(Y.a,null,h.a.createElement($.a,null)),h.a.createElement(U.a,{primary:"Runner"})),h.a.createElement(A.a,{button:!0,key:"Race",onClick:r},h.a.createElement(Y.a,null,h.a.createElement(W.a,null)),h.a.createElement(U.a,{primary:"Race"})))))}}]),n}(h.a.Component),X=Object(f.b)(function(e){return Object(t.a)({},e)},function(e){return{dispatchMenuToggleAction:function(n){return e(Q(n))}}})(Object(v.withStyles)(function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginLeft:12,marginRight:20},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(t.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"}),content:{flexGrow:1,padding:3*e.spacing.unit,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}},{withTheme:!0})(h.a.memo(V))),Z=a(327),ee=a(331),ne=a(332),ae=a.n(ne),te=(a(333),a(45)),re=a.n(te),ce=a(10),se=a(53),oe=a(54),ie=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){n({type:oe.a,payload:e})}},le=a(1439),ue=a.n(le);var pe=Object(v.withStyles)(function(e){return{}})(function(){return h.a.createElement("span",null,h.a.createElement("br",null),h.a.createElement(ue.a,null),h.a.createElement("br",null),h.a.createElement(ue.a,{color:"secondary",variant:"query"}),h.a.createElement("br",null),h.a.createElement(ue.a,null))}),de=a(178),he=a.n(de),fe=a(181),me=a.n(fe);var ge=Object(v.withStyles)(function(e){return{noRaces:{marginRight:"10px",marginLeft:"10px",marginTop:"5px",marginBottom:"5px"}}})(function(e){var n=e.classes;return h.a.createElement(he.a,{className:n.noRaces},h.a.createElement(me.a,{variant:"subheading"},"No race results found for this runner!"))}),be=a(1441),ve=a.n(be);function Re(e){var n=e.key,a=e.value;"null"!==a&&sessionStorage.setItem(n,JSON.stringify(a))}function ke(e){var n=sessionStorage.getItem(e);return n?JSON.parse(n):n}function ye(e){e&&sessionStorage.removeItem(e)}function Ee(e){var n=e.key,a=e.value;"null"!==a&&localStorage.setItem(n,JSON.stringify(a))}function Ce(e){var n=localStorage.getItem(e);return n?JSON.parse(n):n}function xe(e){e&&localStorage.removeItem(e)}var Oe=new(a(1461).AllHtmlEntities);function Se(e,n,a){return we.apply(this,arguments)}function we(){return(we=Object(s.a)(c.a.mark(function e(n,a,t){var r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.join("$$"),s=null,e.next=4,ve.a.get("".concat("https://fellrace-finder-server.herokuapp.com","/runner/").concat(r,"/").concat(a,"/").concat(t)).then(function(e){return s=e.data}).catch(function(e){console.log(e)});case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function je(e,n){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(s.a)(c.a.mark(function e(n,a){var t,r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.join("$$"),r=a.replace("/","**"),r=Oe.encode(r),s=null,e.next=6,ve.a.get("".concat("https://fellrace-finder-server.herokuapp.com","/runnerByRace/").concat(t,"/").concat(r)).then(function(e){return s=e.data}).catch(function(e){console.log(e)});case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Te(e){var n="runnersList".concat(e),a=ke(n);if(a)return{options:a};var t="".concat("https://fellrace-finder-server.herokuapp.com","/autocomplete/runner/").concat(e.toLowerCase());return fetch(t).then(function(e){return e.json()}).then(function(e){var a=[];return e.items.map(function(e){var n=!1;return a.map(function(a){return e.display===a.display&&(n=!0,!0)}),n||a.push(e),n}),Re({key:n,value:a}),{options:a}})}function Ne(e){var n="raceSearch".concat(e),a=ke(n);if(a)return{options:a};var t="".concat("https://fellrace-finder-server.herokuapp.com","/autocomplete/race/").concat(e.toLowerCase());return fetch(t).then(function(e){return e.json()}).then(function(e){var a=[];return console.log(e),e.map(function(e){var n=!1;return a.map(function(a){return e.display===a.display&&(n=!0,!0)}),n||a.push(e),n}),Re({key:n,value:a}),{options:a}})}function Le(e){return De.apply(this,arguments)}function De(){return(De=Object(s.a)(c.a.mark(function e(n){var a,t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat("https://fellrace-finder-server.herokuapp.com","/race/byNames/").concat(n),t=null,e.next=4,ve.a.get(a).then(function(e){return t=e.data}).catch(function(e){console.log(e)});case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ie(e){var n=e.split(" ").map(function(e){return"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)," ")}),a="";return n.map(function(e){return a="".concat(a).concat(e)}),a}var Be=h.a.lazy(function(){return a.e(5).then(a.bind(null,1668))}),qe=h.a.lazy(function(){return a.e(4).then(a.bind(null,1669))}),Me=h.a.lazy(function(){return a.e(6).then(a.bind(null,1670))}),ze=h.a.lazy(function(){return a.e(15).then(a.bind(null,1671))}),Fe=h.a.lazy(function(){return Promise.all([a.e(14),a.e(26)]).then(a.bind(null,1672))}),Ae=h.a.lazy(function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,1673))}),Je=h.a.lazy(function(){return Promise.all([a.e(12),a.e(25)]).then(a.bind(null,1674))}),Ye=h.a.lazy(function(){return Promise.all([a.e(13),a.e(23)]).then(a.bind(null,1675))}),Ke=h.a.lazy(function(){return a.e(18).then(a.bind(null,1676))}),Ue=function(e){return{searchField:{paddingBottom:"5px",paddingLeft:"5px",paddingRight:"5px",marginTop:"-5px",zIndex:"2"},search:{position:"sticky",backgroundColor:"white",zIndex:"2 !important",borderBottom:"1px solid #CCCCCC",top:"40px",paddingTop:"40px",borderTop:"1px solid #CCCCCC",paddingBottom:"2px"},progress:{margin:2*e.spacing.unit}}},Ge="chosenRunners",$e=0,He=function(e){function n(e){var a;return Object(o.a)(this,n),(a=Object(l.a)(this,Object(u.a)(n).call(this,e))).componentDidMount=function(){window.addEventListener("scroll",a.onScroll,!1);var e=Ce(Ge);e&&(a.props.dispatchChosenRunners(e),a.onChange(e)),Z.animateScroll.scrollTo(0)},a.componentWillUnmount=function(){window.removeEventListener("scroll",a.onScroll,!1)},a.shouldComponentUpdate=function(e,n){return!ae.a.isEqual(a.props.classes,e.classes)||(!ae.a.isEqual(a.props.dispatchChosenRace,e.dispatchChosenRace)||(!ae.a.isEqual(a.props.dispatchChosenRunners,e.dispatchChosenRunners)||(!ae.a.isEqual(a.props.dispatchEndIndex,e.dispatchEndIndex)||(!ae.a.isEqual(a.props.dispatchLoadMoreProgress,e.dispatchLoadMoreProgress)||(!ae.a.isEqual(a.props.dispatchLoadingProgress,e.dispatchLoadingProgress)||(!ae.a.isEqual(a.props.dispatchRunnerDetails,e.dispatchRunnerDetails)||(!ae.a.isEqual(a.props.dispatchSticky,e.dispatchSticky)||(!ae.a.isEqual(a.props.menuReducer,e.menuReducer)||(!ae.a.isEqual(a.props.raceReducer,e.raceReducer)||(!ae.a.isEqual(a.props.runnerReducer,e.runnerReducer)||(!ae.a.isEqual(a.props.scrollReducer,e.scrollReducer)||!ae.a.isEqual(a.props.searchReducer,e.searchReducer))))))))))))},a.buildClearButton=function(){return h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:Ue.prototypeprogress})},h.a.createElement(Me,{onClick:a.clearClick}))},a.onScroll=function(){window.scrollY>=165&&!a.props.scrollReducer.sticky?a.props.dispatchSticky(!0):window.scrollY<165&&a.props.scrollReducer.sticky&&a.props.dispatchSticky(!1)},a.scrollToTop=function(){Z.animateScroll.scrollTo(170)},a.performSearch=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,r,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=19;break}if(a.props.dispatchLoadingProgress(!0),a.props.dispatchRunnerDetails(null),a.props.dispatchChosenRace(""),t=a.props.searchReducer.endIndex,r="getRunner".concat(n).replace(" ",""),s=ke(r)){e.next=14;break}return e.next=10,Se(n,$e,t);case 10:o=e.sent,Re({key:r,value:JSON.stringify(o)}),e.next=16;break;case 14:o=JSON.parse(s),ye(r);case 16:a.props.dispatchRunnerDetails(o),a.props.dispatchLoadingProgress(!1),a.scrollToTop();case 19:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.searchForRunners=function(){var e=Object(s.a)(c.a.mark(function e(n,a){var t,r,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=16;break}if(t=[],n.map(function(e){t.push(e.display)}),r="getRunners".concat(t.join("")).concat($e).concat(a).replace(" ",""),s=ke(r)){e.next=13;break}return e.next=8,Se(t,$e,a);case 8:return o=e.sent,Re({key:r,value:JSON.stringify(o)}),e.abrupt("return",o);case 13:o=JSON.parse(s),ye(r);case 15:return e.abrupt("return",o);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e)}));return function(n,a){return e.apply(this,arguments)}}(),a.searchForRunnersByRace=function(){var e=Object(s.a)(c.a.mark(function e(n,a){var t,r,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=16;break}if(t=[],n.map(function(e){t.push(e.display)}),r="getRunnersByRace".concat(t.join("")).concat(a).replace(" ",""),s=ke(r)){e.next=13;break}return e.next=8,je(t,a);case 8:return o=e.sent,Re({key:r,value:JSON.stringify(o)}),e.abrupt("return",o);case 13:o=JSON.parse(s),ye(r);case 15:return e.abrupt("return",o);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e)}));return function(n,a){return e.apply(this,arguments)}}(),a.handleClick=function(){var e=Object(s.a)(c.a.mark(function e(n){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""===(t=a.searchRunnerRef.value.trim())){e.next=8;break}if(Ie(t)===a.state.runnerName){e.next=6;break}return e.next=6,a.performSearch(t);case 6:e.next=9;break;case 8:a.clearClick();case 9:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.clearClick=function(){a.props.dispatchLoadingProgress(!0),a.props.dispatchRunnerDetails(null),a.props.dispatchSticky(!1),a.props.dispatchChosenRunners([]),a.props.dispatchChosenRace(""),a.props.dispatchEndIndex(0),xe(Ge),sessionStorage.clear(),a.props.dispatchLoadingProgress(!1),Z.animateScroll.scrollToTop()},a.scrollToTopClick=function(e){e.preventDefault(),Z.animateScroll.scrollToTop()},a.scrollToBottomClick=function(e){e.preventDefault(),Z.animateScroll.scrollToBottom()},a.loadingProgress=function(){return h.a.createElement(pe,null)},a.noResultsFound=function(){return h.a.createElement(ge,null)},a.buildRaceResult=function(e){var n,a=e;return a&&a.length>0&&(a=a[0]),a.raceInfo&&(n=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:Ue.progress})},h.a.createElement(Ae,{raceInfo:a.raceInfo}))),h.a.createElement("div",{key:a.id},h.a.createElement("br",null),h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:Ue.progress})},h.a.createElement(ze,{race:a})),n,h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:Ue.progress})},h.a.createElement(Fe,{runner:a.runner})))},a.loadMoreOnClick=function(){var e=Object(s.a)(c.a.mark(function e(n){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=a.props.searchReducer.chosenRunners,a.props.dispatchLoadMoreProgress(!0),e.next=5,a.onChange(t);case 5:a.props.dispatchLoadMoreProgress(!1);case 6:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.calculateNextEndIndex=function(e){var n=a.props.runnerReducer.runnerDetails,t=a.props.searchReducer,r=t.endIndex,c=t.chosenRunners;return 0===r?10:e.length===c.length?r+10>n.overallStats.noOfRaces?n.overallStats.noOfRaces:r+10:10},a.onChange=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,r,s,o,i,l,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.runnerReducer.runnersDetails,r=a.props.searchReducer,s=r.chosenRunners,o=r.chosenRace,i=r.endIndex,!(n.length>0)){e.next=16;break}return a.props.dispatchLoadingProgress(!0),l=a.calculateNextEndIndex(n),e.next=7,a.searchForRunners(n,l);case 7:u=e.sent,ae.a.isEqual(s,n)||a.props.dispatchChosenRunners(n),ae.a.isEqual(t,u)||a.props.dispatchRunnerDetails(u),i!==l&&a.props.dispatchEndIndex(l),""!==o&&a.props.dispatchChosenRace(""),Ee({key:Ge,value:n}),a.props.dispatchLoadingProgress(!1),e.next=17;break;case 16:a.clearClick();case 17:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.fetchRunnerByRace=function(){var e=Object(s.a)(c.a.mark(function e(n,t){var r,s,o,i,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.props.runnerReducer.runnersDetails,s=a.props.searchReducer,o=s.chosenRace,i=s.chosenRunners,!(n.length>0)){e.next=13;break}return e.next=5,a.searchForRunnersByRace(n,t);case 5:l=e.sent,t!==o&&a.props.dispatchChosenRace(t),ae.a.isEqual(n,i)||a.props.dispatchChosenRunners(n),ae.a.isEqual(r,l)||a.props.dispatchRunnerDetails(l),Ee({key:Ge,value:n}),a.props.dispatchLoadingProgress(!1),e.next=14;break;case 13:a.clearClick();case 14:case"end":return e.stop()}},e)}));return function(n,a){return e.apply(this,arguments)}}(),a.fetchRunners=function(){var e=Object(s.a)(c.a.mark(function e(n,t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("searching - ",n),a.props.dispatchLoadingProgress(!0),n||t(null,{options:[]}),!(n.length>2)){e.next=11;break}return e.t0=t,e.next=7,Te(n);case 7:e.t1=e.sent,(0,e.t0)(null,e.t1),e.next=12;break;case 11:t(null,{options:[]});case 12:a.props.dispatchLoadingProgress(!1);case 13:case"end":return e.stop()}},e)}));return function(n,a){return e.apply(this,arguments)}}(),a.debouncedFetchRunners=ae.a.debounce(a.fetchRunners,100),a.getRunners=function(e,n){if(!e||e.length<4)return n(null,{options:[]});a.debouncedFetchRunners(e,n)},a.handleChooseRaceChange=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,r,s,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.searchReducer,r=t.chosenRunners,s=t.endIndex,o=n.target.value,a.props.dispatchLoadingProgress(!0),0!==s&&a.props.dispatchEndIndex(0),"all"!==o){e.next=9;break}return e.next=7,a.onChange(r);case 7:e.next=11;break;case 9:return e.next=11,a.fetchRunnerByRace(r,o);case 11:a.scrollToTop();case 12:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.populateOverallStats=function(){var e=a.props.runnerReducer.runnerDetails;return e.overallStats?h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:Ue.progress})},h.a.createElement(Ye,{overallStats:e.overallStats})):null},a.buildChosenRaceList=function(e,n){var t=[];e||(e="");var r=e.split("||");return r.length>1?r.map(function(e){for(var a=0;a<n.length;a++)n[a].name===e&&t.push(n[a])}):n&&(t=n),t.length>1&&(t=t.sort(function(e,n){return new Date(n.dateTime)-new Date(e.dateTime)})),t.map(function(e){return a.buildRaceResult(e)})},a.searchRunnerRef=h.a.createRef(),a}return Object(p.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){var e,n,a,t,r,c,s,o,i,l=this,u=this.props.classes,p=u.progress,f=u.searchField,m=u.search,g=this.props.searchReducer,b=g.loadingProgress,v=g.chosenRunners,R=g.chosenRace,k=g.loadMoreLoading,y=this.props.runnerReducer.runnerDetails,E=this.props.scrollReducer.sticky,C=E?m:"",x=this.props.searchReducer.endIndex;if(b&&(t=this.loadingProgress()),null!=y&&y.races&&y.races.length>0){e=this.buildClearButton(),n=this.populateOverallStats();var O=y.races;0===x&&(x=10),""===R?(a=O.map(function(e){return l.buildRaceResult(e)}),y.overallStats.noOfRaces>x&&(s=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:p})},h.a.createElement(Ke,{onClick:this.loadMoreOnClick})))):(a=this.buildChosenRaceList(R,y.races)).length>x&&(s=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:p})},h.a.createElement(Ke,{onClick:this.loadMoreOnClick}))),c=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:p})},h.a.createElement(Je,{raceNames:y.raceNames,chosenRace:R,onChange:this.handleChooseRaceChange})),k?(o=this.loadingProgress(),s=null,Z.animateScroll.scrollMore(250)):(i=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:p})},h.a.createElement(qe,{onClick:this.scrollToBottomClick})),E&&(r=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:p})},h.a.createElement(Be,{onClick:this.scrollToTopClick}))))}else null!=y&&0===y.races.length&&(a=this.noResultsFound());return h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:C},h.a.createElement(ee.a,{cacheOptions:!0,defaultOptions:!0,className:f,valueKey:"original",labelKey:"display",matchProp:"any",name:"runner-search-field",onChange:this.onChange,loadOptions:this.getRunners,placeholder:"Search Runner",noResultsText:"No runners found",value:v,multi:!0,ignoreAccents:!1}),c,e),i,t,n,a,o,s,r)}}]),n}(d.Component),We=Object(f.b)(function(e){return Object(t.a)({},e)},function(e){return{dispatchLoadingProgress:function(n){return e(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n){n({type:ce.e,payload:e})}}(n))},dispatchRunnerDetails:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(n){n({type:se.a,payload:e})}}(n))},dispatchSticky:function(n){return e(ie(n))},dispatchChosenRunners:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(n){n({type:ce.c,payload:e})}}(n))},dispatchChosenRace:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(n){n({type:ce.b,payload:e})}}(n))},dispatchEndIndex:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(n){n({type:ce.d,payload:e})}}(n))},dispatchLoadMoreProgress:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){n({type:ce.g,payload:e})}}(n))}}})(Object(v.withStyles)(Ue)(h.a.memo(He))),_e=a(212),Qe=a.n(_e),Ve=a(213),Xe=a.n(Ve),Ze=a(214),en=a.n(Ze),nn=a(196),an=a.n(nn),tn=a(55),rn=h.a.lazy(function(){return a.e(5).then(a.bind(null,1668))}),cn=h.a.lazy(function(){return a.e(4).then(a.bind(null,1669))}),sn=h.a.lazy(function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,1673))}),on=h.a.lazy(function(){return a.e(6).then(a.bind(null,1670))}),ln=h.a.lazy(function(){return Promise.all([a.e(2),a.e(19)]).then(a.bind(null,1496))}),un=h.a.lazy(function(){return a.e(17).then(a.bind(null,1677))}),pn=h.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(16)]).then(a.bind(null,1678))}),dn=h.a.lazy(function(){return Promise.all([a.e(9),a.e(21)]).then(a.bind(null,1679))}),hn=function(e){return{searchField:{paddingBottom:"5px",paddingLeft:"5px",paddingRight:"5px",marginTop:"-5px",zIndex:"2"},search:{position:"sticky",backgroundColor:"white",zIndex:"2 !important",borderBottom:"1px solid #CCCCCC",top:"40px",paddingTop:"40px",borderTop:"1px solid #CCCCCC",paddingBottom:"2px"},progress:{margin:2*e.spacing.unit},expansionPanel:{marginTop:"5px",marginBottom:"15px"}}},fn="chosenRaces",mn="directionsDestinationKey",gn=function(e){function n(e){var a;return Object(o.a)(this,n),(a=Object(l.a)(this,Object(u.a)(n).call(this,e))).componentDidMount=function(){window.addEventListener("scroll",a.onScroll,!1);var e=Ce(fn);e&&(a.props.dispatchLoadingProgress(!0),a.props.dispatchChosenRace(e),a.onChange(e),a.props.dispatchLoadingProgress(!1)),Z.animateScroll.scrollTo(0)},a.componentWillUnmount=function(){window.removeEventListener("scroll",a.onScroll,!1)},a.shouldComponentUpdate=function(e,n){return!ae.a.isEqual(a.props.classes,e.classes)||(!ae.a.isEqual(a.props.dispatchChosenRace,e.dispatchChosenRace)||(!ae.a.isEqual(a.props.dispatchLoadingProgress,e.dispatchLoadingProgress)||(!ae.a.isEqual(a.props.dispatchRaceDetails,e.dispatchRaceDetails)||(!ae.a.isEqual(a.props.dispatchSticky,e.dispatchSticky)||(!ae.a.isEqual(a.props.menuReducer,e.menuReducer)||(!ae.a.isEqual(a.props.raceReducer,e.raceReducer)||(!ae.a.isEqual(a.props.scrollReducer,e.scrollReducer)||!ae.a.isEqual(a.props.searchReducer,e.searchReducer))))))))},a.buildClearButton=function(){return h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:hn.prototypeprogress})},h.a.createElement(on,{onClick:a.clearClick}))},a.onScroll=function(){window.scrollY>=165&&!a.props.scrollReducer.sticky?a.props.dispatchSticky(!0):window.scrollY<165&&a.props.scrollReducer.sticky&&a.props.dispatchSticky(!1)},a.scrollToTop=function(){Z.animateScroll.scrollTo(170)},a.loadingProgress=function(){return h.a.createElement(pe,null)},a.noResultsFound=function(){return h.a.createElement(ge,null)},a.scrollToTopClick=function(e){e.preventDefault(),Z.animateScroll.scrollToTop()},a.scrollToBottomClick=function(e){e.preventDefault(),Z.animateScroll.scrollToBottom()},a.onChange=function(){var e=Object(s.a)(c.a.mark(function e(n){var t,r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.raceReducer.raceDetails,r=a.props.searchReducer.chosenRaces,!(n.length>1)){e.next=6;break}return a.props.dispatchChosenRace(r),a.props.dispatchLoadingProgress(!1),e.abrupt("return");case 6:if(1!==n.length){e.next=17;break}return a.props.dispatchLoadingProgress(!0),e.next=10,a.searchForRaces(n);case 10:s=e.sent,ae.a.isEqual(r,n)||a.props.dispatchChosenRace(n),ae.a.isEqual(t,s)||a.props.dispatchRaceDetails(s),Ee({key:fn,value:n}),a.props.dispatchLoadingProgress(!1),e.next=18;break;case 17:a.clearClick();case 18:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.fetchRaces=function(){var e=Object(s.a)(c.a.mark(function e(n,t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("searching - ",n),a.props.dispatchLoadingProgress(!0),n||t(null,{options:[]}),!(n.length>2)){e.next=11;break}return e.t0=t,e.next=7,Ne(n);case 7:e.t1=e.sent,(0,e.t0)(null,e.t1),e.next=12;break;case 11:t(null,{options:[]});case 12:a.props.dispatchLoadingProgress(!1);case 13:case"end":return e.stop()}},e)}));return function(n,a){return e.apply(this,arguments)}}(),a.debouncedFetchRaces=ae.a.debounce(a.fetchRaces,200),a.getRaces=function(e,n){if(!e||e.length<3)return n(null,{options:[]});a.debouncedFetchRaces(e,n)},a.searchForRaces=function(){var e=Object(s.a)(c.a.mark(function e(n){var a,t,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=14;break}if(a="getRaces".concat(n[0].display).replace(" ",""),t=ke(a)){e.next=11;break}return e.next=6,Le(n[0].original);case 6:return r=e.sent,Re({key:a,value:JSON.stringify(r)}),e.abrupt("return",r);case 11:r=JSON.parse(t),ye(a);case 13:return e.abrupt("return",r);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.clearClick=function(){a.props.dispatchLoadingProgress(!0),a.props.dispatchSticky(!1),a.props.dispatchRaceDetails(null),a.props.dispatchChosenRace(null),xe(fn),ye(mn),a.props.dispatchLoadingProgress(!1),Z.animateScroll.scrollToTop()},a.buildRaceInfo=function(e){var n;return e&&(e._latitude>0&&delete e._latitude,n=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:hn.progress})},h.a.createElement(sn,{raceInfo:e}))),h.a.createElement("div",{key:e.id},n)},a.buildResultCategories=function(e,n){var a;return e&&(a=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:n.progress})},h.a.createElement(ln,{categoryRecords:e}))),h.a.createElement(h.a.Fragment,null,h.a.createElement(Qe.a,{key:e.length,className:n.expansionPanel},h.a.createElement(Xe.a,{expandIcon:h.a.createElement(an.a,null)},h.a.createElement(me.a,{className:n.heading},h.a.createElement("b",null,"Overall"))),h.a.createElement(en.a,null,a)))},a.buildYearResultCategories=function(e){var n;return e&&(n=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:hn.progress})},h.a.createElement(un,{races:e}),h.a.createElement("br",null),h.a.createElement("br",null),h.a.createElement("br",null),h.a.createElement("br",null))),n},a.buildYearPerformanceGraph=function(e,n){var a=e.map(function(e){if(e.performance>0)return["".concat(e.year),"".concat(e.performance,"%")]}).filter(function(e){return void 0!==e});return h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:n})},h.a.createElement(pn,{raceData:a}))},a.buildDownwardArrow=function(e){return h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:e})},h.a.createElement(cn,{onClick:a.scrollToBottomClick}))},a.buildMapComponent=function(e,n,a){var t,r=ke("origin");if(!r&&navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){t={lat:e.coords.latitude,lng:e.coords.longitude},Re({key:"origin",value:JSON.stringify(t)})})}else t=JSON.parse(r);return h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:a})},h.a.createElement(dn,{destination:n,origin:t}))},a.searchRaceRef=h.a.createRef(),a}return Object(p.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){var e,n,a,t,r,c,s,o,i,l=this.props.classes,u=l.progress,p=l.searchField,f=l.search,m=this.props.searchReducer,g=m.loadingRaceProgress,b=m.chosenRaces,v=this.props.raceReducer.raceDetails,R=this.props.scrollReducer.sticky,k=R?f:"";if(g&&(n=this.loadingProgress()),b&&b.length>0&&(e=this.buildClearButton()),v){a=this.buildRaceInfo(v.raceInfo),t=this.buildResultCategories(v.categoryRecords,this.props.classes),s=this.buildYearResultCategories(v.races),o=this.buildYearPerformanceGraph(v.races,u);var y={lat:v.properties.latitude,lng:v.properties.longitude};i=this.buildMapComponent(v,y,u),c=this.buildDownwardArrow(u)}return R&&(r=h.a.createElement(d.Suspense,{fallback:h.a.createElement(re.a,{className:u})},h.a.createElement(rn,{onClick:this.scrollToTopClick}))),h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:k},h.a.createElement(ee.a,{cacheOptions:!0,defaultOptions:!0,className:p,valueKey:"original",labelKey:"display",matchProp:"any",name:"race-search-field",onChange:this.onChange,loadOptions:this.getRaces,placeholder:"Search Race",noResultsText:"No race found",value:b,multi:!0,ignoreAccents:!1}),e),i,n,a,o,t,s,c,r)}}]),n}(d.Component),bn=Object(f.b)(function(e){return Object(t.a)({},e)},function(e){return{dispatchLoadingProgress:function(n){return e(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n){n({type:ce.f,payload:e})}}(n))},dispatchChosenRace:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(n){n({type:ce.a,payload:e})}}(n))},dispatchRaceDetails:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(n){n({type:tn.a,payload:e})}}(n))},dispatchSticky:function(n){return e(ie(n))}}})(Object(v.withStyles)(hn)(h.a.memo(gn))),vn="Main-menuoption",Rn=function(e){function n(e){var a;return Object(o.a)(this,n),(a=Object(l.a)(this,Object(u.a)(n).call(this,e))).raceOnClick=function(){var e=Object(s.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),Ee({key:vn,value:"race"}),a.props.dispatchMenuAction({race:!0,runner:!1}),a.props.dispatchMenuToggleAction(!1);case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a.runnerOnClick=function(){var e=Object(s.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),Ee({key:vn,value:"runner"}),a.props.dispatchMenuAction({race:!1,runner:!0}),a.props.dispatchMenuToggleAction(!1);case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),a}return Object(p.a)(n,e),Object(i.a)(n,[{key:"componentWillMount",value:function(){var e=Ce(vn);e&&("race"===e?this.props.dispatchMenuAction({race:!0,runner:!1}):this.props.dispatchMenuAction({race:!1,runner:!0}),this.props.dispatchMenuToggleAction(!1))}},{key:"render",value:function(){var e,n=this.props.menuReducer,a=n.race,t=n.runner,r=!1;return e=a?h.a.createElement(bn,null):h.a.createElement(We,null),(a||t)&&(r=!0),h.a.createElement(h.a.Fragment,null,h.a.createElement(X,{raceOnClick:this.raceOnClick,runnerOnClick:this.runnerOnClick,closeMenu:r}),e)}}]),n}(d.PureComponent);n.default=Object(f.b)(function(e){return Object(t.a)({},e)},function(e){return{dispatchMenuAction:function(n){return e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(n){n({type:_.a,payload:e})}}(n))},dispatchMenuToggleAction:function(n){return e(Q(n))}}})(Rn)}}]);
//# sourceMappingURL=27.e8a32d87.chunk.js.map