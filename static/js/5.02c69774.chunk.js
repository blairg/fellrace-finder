(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1462:function(e,n,t){"use strict";t.r(n);var a=t(227),r=t.n(a),c=t(228),s=t(36),l=t(37),o=t(55),u=t(38),i=t(56),p=t(0),f=t.n(p),h=t(1232),m=t(1240),d=t(1242),v=t.n(d),g=(t(1243),t(17)),b=t(34),k=t.n(b),R=t(1245),x=t.n(R);var y=Object(g.withStyles)(function(e){return{}})(function(){return f.a.createElement("span",null,f.a.createElement("br",null),f.a.createElement(x.a,null),f.a.createElement("br",null),f.a.createElement(x.a,{color:"secondary",variant:"query"}),f.a.createElement("br",null),f.a.createElement(x.a,null))}),S=t(162),E=t.n(S),w=t(164),O=t.n(w);var C=Object(g.withStyles)(function(e){return{noRaces:{marginRight:"10px",marginLeft:"10px",marginTop:"5px",marginBottom:"5px"}}})(function(e){var n=e.classes;return f.a.createElement(E.a,{className:n.noRaces},f.a.createElement(O.a,{variant:"subheading"},"No race results found for this runner!"))}),N=t(1249),j=t.n(N);function I(e){var n=e.key,t=e.value;"null"!==t&&sessionStorage.setItem(n,JSON.stringify(t))}function T(e){var n=sessionStorage.getItem(e);return n?JSON.parse(n):n}function P(e){e&&sessionStorage.removeItem(e)}function B(e){var n=e.key,t=e.value;"null"!==t&&localStorage.setItem(n,JSON.stringify(t))}var J=new(t(1269).AllHtmlEntities);function L(e,n,t){return z.apply(this,arguments)}function z(){return(z=Object(c.a)(r.a.mark(function e(n,t,a){var c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.join("$$"),s=null,e.next=4,j.a.get("".concat("https://fellrace-finder-server.herokuapp.com","/runner/").concat(c,"/").concat(t,"/").concat(a)).then(function(e){return s=e.data}).catch(function(e){console.log(e)});case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function F(e,n){return M.apply(this,arguments)}function M(){return(M=Object(c.a)(r.a.mark(function e(n,t){var a,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.join("$$"),c=t.replace("/","**"),c=J.encode(c),s=null,e.next=6,j.a.get("".concat("https://fellrace-finder-server.herokuapp.com","/runnerByRace/").concat(a,"/").concat(c)).then(function(e){return s=e.data}).catch(function(e){console.log(e)});case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function D(e){var n="runnersList".concat(e),t=T(n);if(t)return{options:t};var a="".concat("https://fellrace-finder-server.herokuapp.com","/autocomplete/runner/").concat(e.toLowerCase());return fetch(a).then(function(e){return e.json()}).then(function(e){var t=[];return e.items.map(function(e){var n=!1;return t.map(function(t){return e.display===t.display&&(n=!0,!0)}),n||t.push(e),n}),I({key:n,value:t}),{options:t}})}function $(e){var n=e.split(" ").map(function(e){return"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)," ")}),t="";return n.map(function(e){return t="".concat(t).concat(e)}),t}var A=f.a.lazy(function(){return Promise.all([t.e(0),t.e(1),t.e(6)]).then(t.bind(null,1453))}),K=f.a.lazy(function(){return Promise.all([t.e(0),t.e(1),t.e(7)]).then(t.bind(null,1454))}),U=f.a.lazy(function(){return Promise.all([t.e(0),t.e(1),t.e(8)]).then(t.bind(null,1455))}),Y=f.a.lazy(function(){return Promise.all([t.e(0),t.e(9)]).then(t.bind(null,1456))}),q=f.a.lazy(function(){return Promise.all([t.e(1),t.e(22),t.e(10)]).then(t.bind(null,1457))}),H=f.a.lazy(function(){return Promise.all([t.e(2),t.e(11)]).then(t.bind(null,1458))}),W=f.a.lazy(function(){return Promise.all([t.e(0),t.e(19),t.e(12)]).then(t.bind(null,1459))}),G=f.a.lazy(function(){return Promise.all([t.e(0),t.e(1),t.e(21),t.e(13)]).then(t.bind(null,1460))}),Q=f.a.lazy(function(){return Promise.all([t.e(0),t.e(14)]).then(t.bind(null,1461))}),V=function(e){return{searchField:{paddingBottom:"5px",paddingLeft:"5px",paddingRight:"5px",marginTop:"-20px",zIndex:"2"},search:{position:"sticky",top:"0px",backgroundColor:"white",zIndex:"2 !important"},progress:{margin:2*e.spacing.unit}}},X="chosenRunners",Z=function(e){function n(e){var t;Object(s.a)(this,n),(t=Object(o.a)(this,Object(u.a)(n).call(this,e))).componentDidMount=function(){window.addEventListener("scroll",t.onScroll,!1),t.onChange(t.state.chosenRunners)},t.componentWillUnmount=function(){window.removeEventListener("scroll",t.onScroll,!1)},t.buildClearButton=function(){return f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:V.prototypeprogress})},f.a.createElement(U,{onClick:t.clearClick}))},t.onScroll=function(){window.scrollY>=165&&!t.state.sticky?t.setState({sticky:!0}):window.scrollY<165&&t.state.sticky&&t.setState({sticky:!1})},t.scrollToTop=function(){h.animateScroll.scrollTo(170)},t.performSearch=function(){var e=Object(c.a)(r.a.mark(function e(n){var a,c,s,l,o,u,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=17;break}if(t.setState({runner:null,loadingResults:!0,chosenRace:""}),a=t.state,c=a.startIndex,s=a.endIndex,l="getRunner".concat(n).replace(" ",""),o=n,u=T(l)){e.next=13;break}return e.next=9,L(n,c,s);case 9:i=e.sent,I({key:l,value:JSON.stringify(i)}),e.next=15;break;case 13:i=JSON.parse(u),P(l);case 15:t.setState({runner:i,runnerName:o,loadingResults:!1}),t.scrollToTop();case 17:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),t.searchForRunners=function(){var e=Object(c.a)(r.a.mark(function e(n,a){var c,s,l,o,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=17;break}if(c=t.state.startIndex,s=[],n.map(function(e){s.push(e.display)}),l="getRunners".concat(s.join("")).concat(c).concat(a).replace(" ",""),o=T(l)){e.next=14;break}return e.next=9,L(s,c,a);case 9:return u=e.sent,I({key:l,value:JSON.stringify(u)}),e.abrupt("return",u);case 14:u=JSON.parse(o),P(l);case 16:return e.abrupt("return",u);case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),t.searchForRunnersByRace=function(){var e=Object(c.a)(r.a.mark(function e(n,t){var a,c,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=16;break}if(a=[],n.map(function(e){a.push(e.display)}),c="getRunnersByRace".concat(a.join("")).concat(t).replace(" ",""),s=T(c)){e.next=13;break}return e.next=8,F(a,t);case 8:return l=e.sent,I({key:c,value:JSON.stringify(l)}),e.abrupt("return",l);case 13:l=JSON.parse(s),P(c);case 15:return e.abrupt("return",l);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),t.handleClick=function(){var e=Object(c.a)(r.a.mark(function e(n){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""===(a=t.searchRunnerRef.value.trim())){e.next=8;break}if($(a)===t.state.runnerName){e.next=6;break}return e.next=6,t.performSearch(a);case 6:e.next=9;break;case 8:t.clearClick();case 9:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),t.clearClick=function(){var e;t.setState({sticky:!1,runner:null,runnerName:null,loadingResults:!1,chosenRace:"",chosenRunners:[],endIndex:0}),(e=X)&&localStorage.removeItem(e),sessionStorage.clear(),h.animateScroll.scrollToTop()},t.scrollToTopClick=function(e){e.preventDefault(),h.animateScroll.scrollToTop()},t.scrollToBottomClick=function(e){e.preventDefault(),h.animateScroll.scrollToBottom()},t.loadingProgress=function(){return f.a.createElement(y,null)},t.noResultsFound=function(){return f.a.createElement(C,null)},t.buildRaceResult=function(e){var n;return e.raceInfo&&(n=f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:V.progress})},f.a.createElement(H,{raceInfo:e.raceInfo}))),f.a.createElement("div",{key:e.id},f.a.createElement("br",null),f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:V.progress})},f.a.createElement(Y,{race:e})),n,f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:V.progress})},f.a.createElement(q,{runner:e.runner})))},t.loadMoreOnClick=function(){var e=Object(c.a)(r.a.mark(function e(n){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a=t.state.chosenRunners,t.setState({loadMoreLoading:!0}),e.next=5,t.onChange(a);case 5:t.setState({loadMoreLoading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),t.calculateNextEndIndex=function(e){var n=t.state,a=n.endIndex,r=n.chosenRunners,c=n.runner;return 0===a?10:e.length===r.length?a+10>c.overallStats.noOfRaces?c.overallStats.noOfRaces:a+10:10},t.onChange=function(){var e=Object(c.a)(r.a.mark(function e(n){var a,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>0)){e.next=10;break}return t.setState({loadingResults:!0}),a=t.calculateNextEndIndex(n),e.next=5,t.searchForRunners(n,a);case 5:c=e.sent,t.setState({runner:c,runnerName:n[0].display,loadingResults:!1,chosenRunners:n,endIndex:a,chosenRace:""}),B({key:X,value:n}),e.next=11;break;case 10:t.clearClick();case 11:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),t.fetchRunnerByRace=function(){var e=Object(c.a)(r.a.mark(function e(n,a){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>0)){e.next=9;break}return t.setState({loadingResults:!0}),e.next=4,t.searchForRunnersByRace(n,a);case 4:c=e.sent,t.setState({runner:c,runnerName:n[0].display,loadingResults:!1,chosenRunners:n,chosenRace:a}),B({key:X,value:n}),e.next=10;break;case 9:t.clearClick();case 10:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),t.fetchRunners=function(){var e=Object(c.a)(r.a.mark(function e(n,t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("searching - ",n),n||t(null,{options:[]}),!(n.length>2)){e.next=10;break}return e.t0=t,e.next=6,D(n);case 6:e.t1=e.sent,(0,e.t0)(null,e.t1),e.next=11;break;case 10:t(null,{options:[]});case 11:case"end":return e.stop()}},e,this)}));return function(n,t){return e.apply(this,arguments)}}(),t.debouncedFetchRunners=v.a.debounce(t.fetchRunners,100),t.getRunners=function(e,n){if(!e||e.length<3)return n(null,{options:[]});t.debouncedFetchRunners(e,n)},t.handleChooseRaceChange=function(){var e=Object(c.a)(r.a.mark(function e(n){var a,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state.chosenRunners,c=n.target.value,t.setState({loadingResults:!0,endIndex:0}),"all"!==c){e.next=8;break}return e.next=6,t.onChange(a);case 6:e.next=10;break;case 8:return e.next=10,t.fetchRunnerByRace(a,c);case 10:t.scrollToTop();case 11:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}(),t.populateOverallStats=function(){var e=t.state.runner;return e.overallStats?f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:V.progress})},f.a.createElement(G,{overallStats:e.overallStats})):null},t.buildChosenRaceList=function(e,n){var a=[],r=e.split("||");return r.length>1?r.map(function(e){for(var t=0;t<n.length;t++)if(n[t][0].name===e){a.push(n[t][0]);break}}):n&&(a=n[0]),a.map(function(e){return t.buildRaceResult(e)})},t.searchRunnerRef=f.a.createRef();var a=function(e){var n=localStorage.getItem(e);return n?JSON.parse(n):n}(X),l=[];return a&&(l=a),t.state={runnerName:"",runner:null,races:null,sticky:!1,loadingResults:!0,value:l,chosenRace:"",chosenRunners:l,startIndex:0,endIndex:0,loadMoreLoading:!1},t}return Object(i.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e,n,t,a,r,c,s,l,o,u=this,i=this.state,d=i.runner,v=i.chosenRace,g=i.loadingResults,b=i.sticky,R=i.chosenRunners,x=i.endIndex,y=i.loadMoreLoading,S=this.props.classes,E=S.progress,w=S.searchField,O=S.search,C=b?O:"";if(g&&(a=this.loadingProgress()),null!=d&&d.races&&d.races.length>0){e=this.buildClearButton(),n=this.populateOverallStats();var N=d.races;""===v?(t=N.map(function(e){return u.buildRaceResult(e)}),d.overallStats.noOfRaces>x&&(s=f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:E})},f.a.createElement(Q,{onClick:this.loadMoreOnClick})))):(t=this.buildChosenRaceList(v,d.races),d.races>x&&(s=f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:E})},f.a.createElement(Q,{onClick:this.loadMoreOnClick})))),c=f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:E})},f.a.createElement(W,{raceNames:d.raceNames,chosenRace:v,onChange:this.handleChooseRaceChange})),y?(l=this.loadingProgress(),s=null,h.animateScroll.scrollMore(170)):(o=f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:E})},f.a.createElement(K,{onClick:this.scrollToBottomClick})),b&&(r=f.a.createElement(p.Suspense,{fallback:f.a.createElement(k.a,{className:E})},f.a.createElement(A,{onClick:this.scrollToTopClick}))))}else null!=d&&0===d.races.length&&(t=this.noResultsFound());return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:C},f.a.createElement(m.a,{cacheOptions:!0,defaultOptions:!0,className:w,valueKey:"original",labelKey:"display",matchProp:"any",name:"runner-search-field",onChange:this.onChange,loadOptions:this.getRunners,placeholder:"Search Runner",noResultsText:"No runners found",value:R,multi:!0,ignoreAccents:!1}),c,e),o,a,n,t,l,s,r)}}]),n}(p.PureComponent);n.default=Object(g.withStyles)(V)(Z)}}]);
//# sourceMappingURL=5.02c69774.chunk.js.map